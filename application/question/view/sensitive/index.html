{layout name='layout' /}

<div id='app'>
    <section>
        <router-view></router-view>
    </section>
</div>
{// 敏感字编辑模板}
<script id="wordEdit_template" type="text/v-template">
    <div>
         <form @submit.prevent="submit">
            <label class="block mt5 mb5 ml5">敏感:</label>
            <textarea  v-model='word' style="width:700px;height:300px;" ></textarea> <br/>
            <input type="submit" value="提交" class="mt5"/><br/>
            
            <p>{{message}}</p>

        </form>
    </div>
</script>
<script type="text/javascript">
    (function (Vue) {

        // 通用加载模板方法
        var loadTemplate = function (name) {
            return document.getElementById(name + "_template").innerHTML;
        }


        // 敏感字模板

        var WordEdit = Vue.extend({
            template: loadTemplate('wordEdit'),
            data: function () {
                this.ajaxSensitiveEdit();
                return {
                    word: '',
                    message: ''
                }
            },
            methods: {
                ajaxSensitiveEdit: function () {
                    var vm = this;
                    this.$http.post('__QUESTION_CONTROL__/whitelist/ajaxSensitiveEdit').then((response) => {

                        vm.word = response.body;
                    })
                },
                submit: function (event) {
                    var vm = this;

                    if (vm.word == '') {
                        vm.message = '敏感字不能为空';
                        return;
                    }

                    if (confirm("你确定要修改敏感字库吗？")) {
                        vm.message = '';
                        this.$http.post('__QUESTION_CONTROL__/whitelist/ajaxSensitiveSubmit',
                            { params: JSON.stringify(vm.word) }).then((response) => {
                                // this.whitelist = response.data.data;
                                // this.count = response.data.msg.count;

                            })

                        return;
                    }
                }
            }
        })

        var App = Vue.extend({})

        var router = new VueRouter()

        router.map({
            '/wordEdit': {
                name: 'wordEdit',
                component: WordEdit
            }
        })
        router.redirect({
            '/': 'wordEdit'
        })
        router.start(App, '#app')
    })(Vue) 
</script>